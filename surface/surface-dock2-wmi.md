---
title: Gestire Surface Dock 2 con WMI
description: Questo articolo spiega come usare WMI per monitorare e gestire in remoto il firmware, lo stato dei criteri e i dati correlati più recenti nei dispositivi Surface Dock 2.
ms.prod: w10
ms.mktglfcycl: manage
ms.localizationpriority: medium
ms.sitesec: library
author: coveminer
ms.author: greglin
ms.topic: article
ms.date: 10/12/2020
ms.reviewer: hachidan
manager: laurawi
audience: itpro
appliesto:
- Windows 10
- Windows 11
ms.openlocfilehash: 658632220dfa87aa88fa233a7d55c311042a91cc
ms.sourcegitcommit: beb2f9db90b19b74da6cdee8717cc0888f3b1d70
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/16/2022
ms.locfileid: "12448899"
---
# <a name="manage-surface-dock-2-with-wmi"></a>Gestire Surface Dock 2 con WMI

il supporto Windows Management Instrumentation (WMI) offre un ricco set di informazioni diagnostiche che consentono agli amministratori IT di monitorare e gestire in remoto il firmware, lo stato dei criteri e i dati correlati più recenti nei dispositivi Surface Dock 2. È possibile utilizzare WMI con Windows PowerShell, System Center Operations Manager e altri strumenti. Per ulteriori informazioni su WMI, vedere [Utilizzo di WMI](/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true). 

Per abilitare il supporto WMI, vai a [Driver e firmware di Surface Dock 2](https://www.microsoft.com/download/details.aspx?id=101317) e scarica il pacchetto appropriato:

**SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;Version&#62;_x64.msi:**<br>

- Surface Pro (5° generazione e versioni successive)
- Surface Book (2° generazione e versioni successive)
- Surface Go (tutte le generazioni)
- Surface Laptop (tutte le generazioni)
- Surface Laptop Go

 **SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;Version&#62;_arm64.msi:** <br>

- Surface Pro X

## <a name="using-wmi-with-surface-dock-2"></a>Utilizzo di WMI con Surface Dock 2

1. Per enumerare tutte le istanze del componente dock:

    ```PowerShell
    Get-CimInstance -Namespace "root/Surface" -Class "SurfaceDockComponent" 
    ```
2. Per accedere alle descrizioni delle proprietà della classe WMI, aprire un prompt dei comandi e immettere comandi WMI dove **Proprietà** è una delle proprietà elencate nella tabella 1.

    ```PowerShell
     Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["<Property>"]
    ```

- **Esempio:** Per accedere alla descrizione della **proprietà Version** Common Information Model (CIM), immettere quanto segue:
    ```PowerShell
    (Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["Version"].Qualifiers["Description"].Value
    ```
 
 ### <a name="table-1-surface-dock-2-wmi-reference"></a>Tabella 1. Riferimento WMI per Surface Dock 2

| Proprietà         | Tipo   | Valori previsti                                                                                                                                                                                                            | Descrizione                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ComponentName    | Stringa | "Microcontroller" <br>"Hub USB 1" <br>"Hub USB 2" <br>"Display Port Hub" <br>"Power Delivery Controller" <br>"Codec audio" <br>"Controller Ethernet"                                                                         | La proprietà seguente elenca il nome specifico del componente del dispositivo a cui corrispondono i dati della classe CIM (Common Information Model) corrispondenti.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| DeviceName       | Stringa | "Surface Dock 1" <br>"Surface Dock 2"                                                                                                                                                                                        | La proprietà seguente contiene il nome del dispositivo dock a cui appartiene il componente del dispositivo specifico.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DockSerialNumber | Stringa | Numero seriale a 12 cifre contenente solo valori numerici                                                                                                                                                           | La proprietà seguente registra il numero di serie del dispositivo dock collegato. Questo numero di serie corrisponde esattamente a ogni componente che appartiene allo stesso dispositivo dock. Per riferimento, questo numero di serie può essere trovato fisicamente nella parte inferiore del Surface Dock stesso.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Id               | uint16 | 0, 1, 2, ..., 65535                                                                                                                                                                                                          | La proprietà seguente è un ID univoco che inizia da zero (0) e conta in su. Questa variabile viene utilizzata per numerare le istanze WMI enumerate.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| LastUpdateStatus | Stringa | "Success" <br>"PendingDockReattach" <br>"Failed"                                                                                                                                                                             | La proprietà seguente illustra in dettaglio lo stato CFU (Component Firmware Update) dell'ultimo tentativo per il componente del dispositivo in questione. I valori possibili sono: **Success,** **Pending Dock Reattach e** **Failed.**<br><br><br>- **Success** indica che il nuovo firmware applicato in precedenza è stato applicato correttamente<br>- **Pending Dock Reattach** indica che è in sospeso un nuovo aggiornamento per il componente del dispositivo e l'utente deve scollegare e ricollegare il connettore Surface del Dock per applicare il nuovo aggiornamento.<br>- **Failed** indica che si è verificato un possibile errore legittimo durante il processo CFU o che la periferica non è stata avviato nella versione prevista. In caso **di** errore, non si tratta di un'indicazione del funzionamento del dispositivo, ma di un errore durante il tentativo di aggiornare il dispositivo. In tal caso, il firmware precedente continuerà a essere eseguito.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| PolicyState      | Stringa | "Abilitato" <br>"Disabilitato"                                                                                                                                                                                                     | La proprietà seguente indica il criterio SEMM (Surface Enterprise Management Mode) corrente per il componente del dispositivo. I valori possibili sono: **Enabled** e **Disabled.**<br><br><br>- **Enabled** indica che il sistema SEMM ha consentito al dispositivo host di accedere e usare il componente del dispositivo<br>- **Disabled** indica che il sistema SEMM non è consentito e pertanto ha impedito al computer host di accedere e usare il componente del dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProductId        | String[] | Elenco di stringhe esadecimali, che possono variare da "0x0000" a "0xFFFF"                                                                                                                                                        | La proprietà seguente classifica l'ID prodotto (PID) del componente del dispositivo. È possibile che siano elencati più PID. Nel caso di un hub USB, ad esempio, entrambi i dispositivi Super Speed (SS) e High Speed (HS) vengono suddivisi in un singolo "Hub". Di conseguenza, all'interno di questa matrice verranno elencati due (2) PIN.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProvisionedState         | boolean | True o False                                                                                                                                                        | La proprietà seguente descrive lo stato di provisioning di Surface Enterprise Management Mode (SEMM) del dispositivo Surface Dock. Lo stato di cui è stato eseguito il provisioning è identico per ogni componente che appartiene allo stesso dispositivo dock. I valori possibili sono True o False. Il valore true indica che il dispositivo Surface Dock è attualmente gestito e pertanto la funzionalità delle porte potrebbe essere limitata. Per ulteriori informazioni, vedere il campo della proprietà "PolicyState". Il valore false indica che il dispositivo Surface Dock non è attualmente gestito e non ha restrizioni di funzionalità imposte.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Stato           | Stringa | "OK" <br>"Disconnesso" <br>"Errore" <br>"Mancante" <br>"DeviceHandleInUse" <br>"Disabilitato" <br>"NotSupportedByWmi"                                                                                                             | La proprietà seguente descrive lo stato della connessione del Dock al computer host. I valori possibili sono: **OK,** **Disconnected,** **Error,** **Missing,** **DeviceHandleInUse,Disabled** **e** **NotSupportedByWmi.**   <br>- **OK** indica che il dispositivo è connesso correttamente al computer host e non esistono problemi, che ne impedirebbe la funzionalità <br>- **Disconnesso** indica che il connettore Surface, che fornisce la connessione per tutti i componenti del dispositivo, non è attualmente collegato al computer host. <br>- **L'errore** indica un potenziale problema con l'istanza del dispositivo e l'interfaccia del dispositivo è più che probabile etichettata con un punto esclamativo giallo in Gestione dispositivi: controllare la **proprietà StatusCode** per informazioni più dettagliate sul tipo di errore che si è verificato. <br>- **Mancante** indica che il dispositivo avrebbe dovuto essere enumerato nel computer host, ma per qualche motivo no. La **proprietà StatusCode** contenerà il valore 24 per indicare questa situazione errata.<br>- **DeviceHandleInUse** indica che un altro processo sta attualmente comunicando con il dispositivo, il che impedisce a questo provider di istanze di Strumentazione gestione Windows (WMI) di comunicare con le sue richieste di comunicazione. Provare a eseguire di nuovo il comando WMI. <br> - **Disabled** indica che il criterio SEMM (Surface Enterprise Management Mode) corrente non è consentito e pertanto ha impedito al computer host di accedere e usare il componente del dispositivo. Per ulteriori **informazioni, vedere** il campo della proprietà PolicyState.<br>- **NotSupportedByWmi** indica che il dock connesso non è attualmente supportato da questo provider WMI. Questo stato verrà visualizzato per Surface Dock 1, attualmente non supportato da questo provider di istanze WMI.|
| StatusCode       | uint32 | [Codice di errore di Gestione](/windows-hardware/drivers/install/device-manager-error-messages) dispositivi ottenuto dalla CIM_LogicalDevice WMI (all'interno *di cimwin32.mof*) | La proprietà seguente fornisce il codice di errore di Gestione dispositivi per il componente dock specificato. Il valore zero (0) indica che il componente dock funziona correttamente. un valore maggiore di zero (0) indica un problema o un possibile errore con il componente dock. Poiché il componente dock può enumerare con diverse interfacce di dispositivo, è possibile che siano presenti ulteriori codici di errore di Gestione dispositivi. Questo campo di proprietà elenca solo un singolo codice di errore anche se sono disponibili più codici di errore. Gestione dispositivi etichetta il dispositivo con un punto esclamativo giallo solo quando si sono verificati determinati codici di errore.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| VendorId         | Stringa | Stringa esadecimale che può variare da "0x0000" a "0xFFFF"                                                                                                                                                                        | La proprietà seguente nota l'ID fornitore (VID) specifico del componente del dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Versione          | Stringa | Stringa di versione con il formato seguente: "x.y.z", dove x, y e z sono valori numerici.                                                                                                                            | La proprietà seguente specifica la versione corrente del firmware, attualmente in esecuzione nel componente del dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |


## <a name="learn-more"></a>Scopri di più

- [Proteggere le porte del Surface Dock 2 con SEMM](secure-surface-dock-ports-semm.md)
- [Novità di Surface Dock 2](surface-dock-whats-new.md)
- [Codici di errore di Gestione dispositivi](/windows-hardware/drivers/install/device-manager-error-messages)
- [Utilizzo di WMI](/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true)
